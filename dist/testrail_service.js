// Generated by CoffeeScript 2.4.1
(function() {
  var TestRailApi, TestRailService, co;

  co = require('co');

  TestRailApi = require('./testrail_api');

  TestRailService = (function() {
    class TestRailService {
      constructor(config, suite_config, opts, testrail_metrics) {
        this.config = config;
        this.suite_config = suite_config;
        this.opts = opts;
        this.testrail_metrics = testrail_metrics;
        //    @api = new TestRailApi @config, @opts, @suite_config, (@testrail_metrics[@suite_config.project_symbol] or [])
        this.api = new TestRailApi(this.config, this.opts, this.suite_config, this.testrail_metrics);
      }

    };

    TestRailService.prototype.sendTestResults = co.wrap(function*() {
      var case_ids, testrun_id;
      case_ids = (yield this.api.fetchCases());
      if (this.opts.newrun === true) {
        testrun_id = (yield this.api.generateTestRun(case_ids, this.opts.runid));
      } else {
        testrun_id = this.opts.runid;
      }
      return (yield this.api.addResults(testrun_id));
    });

    TestRailService.prototype.sendResultsPerCase = co.wrap(function*() {
      var testrun_id;
      testrun_id = this.opts.runid;
      return (yield this.api.addResultsPerCase(testrun_id));
    });

    return TestRailService;

  }).call(this);

  module.exports = TestRailService;

}).call(this);

//# sourceMappingURL=testrail_service.js.map
